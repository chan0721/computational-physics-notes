# (25.9.25) Computation Physcics B

## class 1

- based on the density of particles to determine the spatial resolution.(grid-based vs particle-based)
  - smoothed particle hydrodynamics (SPH)
    - particles have volume, and we use the density of particles to describe it.
    - $$ A(\vec{r}) = \sum_i \frac{m_i}{\rho_i} W(\vec{x}-\vec{x}_i, h) $$
      - i: index of the particle
      - $ m_i $: mass of particle i
      - $ \rho_i $: density of particle i
      - h: smoothing length, which means we smooth the mass of the particle to a volume with radius h.
      - W: smoothing kernel, which is a function of distance and smoothing length.
      - change $A_i \rightarrow \rho_i$, then the equation becomes
        - $$ \rho(\vec{r}) = \sum_i m_i W(\vec{x}-\vec{x}_i, h) $$
        - this means the density at point r is contributed by all the particles, and the contribution is determined by the distance between point r and particle i, as well as the smoothing length h.(The kernel function W is the power of the particle mass)
      - this method transform the disscrete particles to a continuous field, and seems not to contain something about particle interaction.
      - when gravity is considered, there may be some problems.
        - when two particles are very close, the gravity between them will be very large, which may lead to numerical instability.
        - so we need to soften the gravity when two particles are very close.
        - $$ \vec{F} = \frac{G m_1 m_2}{r^2 + \epsilon^2} \hat{r} $$
          - $ \epsilon $: softening length, which is similar to the smoothing length h.
          - this means when the distance between two particles is smaller than $ \epsilon $, the gravity will not increase anymore.
          - this can avoid numerical problems, but also means we lose some information about small scale structures.
  - discretization by frequencies
    - spectral method
      - Fourier decomposition
        - $$f(x,t) = \sum_k \hat{f}(t) e^{ikx} $$ transform from the k space to t space.
        - if we input too many waves into it, there may exist a "Gibbs spike"
        - this method is not suitable for fluid discontinuity, such as shock waves.
        - Dedalus -- recommended for spectral method



## class 2

- pros and cons
  - spectral method
    - pros: high resolution, low computational cost
    - cons: not suitable for discontinuity(for example, high Mach number flow), only able to solve periodic boundary condition.(idealized geometries)
    - application: incompressible turbulence($\mathrm{M} \ll 1$), idealized setup(hydrogen atom)
  - particle-based
    - pros: ODEs, easy to cover large dynamic range(particles flow with the fluid field,high density -> high resolution -> dissolve the physical process)(cosmic web -> dark matter halo -> galaxy -> star formation), 
    - cons: resolution restricted by smooth length and softening length, low resolution and hard to capture instability(smoothing curve will suppress the instability), disable to include magnetic field($\nabla \cdot B = 0$ is hard to satisfy)(divengence cleaning), so MHD simulation is hard to do.
    - application: cosmological simulation, galaxy formation
  - grid-based
    - pros: high order accuracy, easy to capture shock waves and instabilities(complex physical processes)
    - cons: PDEs, hard for coding, high computational cost, hard to cover large dynamic range(even with adaptive mesh refinement, the resolution is still limited by the finest grid)
    - application: localized simulation, compressible and incompressible turbulence
  - not include plasma and binetic simulation -- not hydrodynamic equations but Maxwell equations
    - particle-in-cell (PIC)(for cosmic rays we use this method)
    - radiative transfer(absorption, reemission, leaping)(can couple with hydrodynamic simulation)

- basic structure of numerical simulations
  - initial valued problem(IVP) -- give the initial condition to see the time revolution

  - boundary valued problem(BVP) -- specify the condition and fix the solution
