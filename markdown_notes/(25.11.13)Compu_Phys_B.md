# (25.11.13) Computational Physics B

## class 1

- reconstruction method
  - the core idea is to use concrete values to reconstruct the slopes and avoid unphysical oscillations.
  - piecewise constant
    - $ \left( \frac{\partial a}{\partial x} \right)_i = 0 $
    - this is 1st order accurate
  - piecewise linear
    - $ \left( \frac{\partial a}{\partial x} \right)_i = \frac{a_{i+1}-a_{i}}{\Delta x_i} $
    - $ a_{i+1/2,l} = a_i + \frac{1}{2} \Delta a_i $
    - this method is 2nd order accurate
  - piecewise parabolic
    - $ \left( \frac{\partial a}{\partial x} \right)_i = \frac{3}{2} \frac{a_{i+1}-a_{i-1}}{2 \Delta x_i} - \frac{1}{4} \left( \frac{\Delta a_{i+1}}{\Delta x_{i+1}} + \frac{\Delta a_{i-1}}{\Delta x_{i-1}} \right) $
    - this method is 3rd order accurate
  - after the interpolation we get a left and right value at each cell interface.
    - to decide which value to use, we need a Riemann solver.
      - $ R(a_l, a_r) = \begin{cases} F(a_l) & \text{if } u > 0 \\ F(a_r) & \text{if } u < 0 \end{cases} $
      - this means that the information flows from left to right if $ u > 0 $, so we use the left state to calculate the flux, and vice versa.
  - slope limiters
    - to avoid unphysical oscillations near discontinuities, we can use slope limiters to limit the slope.
    - minmod limiter
      - $ \left( \frac{\partial a}{\partial x} \right)_i = \text{minmod} \left( \frac{a_i - a_{i-1}}{\Delta x}, \frac{a_{i+1} - a_i}{\Delta x} \right) $
      - where $$ \text{minmod}(a, b) = \begin{cases} \text{sgn}(a) \min(|a|, |b|) & \text{if } \text{sgn}(a) = \text{sgn}(b) \\ 0 & \text{otherwise} \end{cases} $$
      - this limiter helps to maintain stability and accuracy in the presence of discontinuities and can get rid of extremia of slopes.
- reference book
  - "Riemann Solvers and Numerical Methods for Fluid Dynamics" , Springer


## class 2

- Burgers' equation
  - $ \frac{\partial u}{\partial t} + u \frac{\partial u}{\partial x} = 0 $
  - this is a non-linear advection equation, and the wave speed depends on the amplitude.
    - when u is a sinusoidal function, the characteristics can cross each other, leading to shock formation.
    - when u is a step function, the characteristics diverge, leading to rarefaction waves.
  - rewrite the equation in conservative form:
    - $ \frac{\partial u}{\partial t} + \frac{\partial}{\partial x} \left( \frac{u^2}{2} \right) = 0 $
    - then we can use finite-volume method to solve it.
    - $ u^{n+1}_{i+1/2,l} = u^n_i + \frac{\Delta x}{2} (1 - \frac{\Delta t}{\Delta x} u_i ) \left( \frac{\partial u}{\partial x} \right)^n_i  $, and the flux is $ f(u) = \frac{u^2}{2} $
    - $u_i$ varied from zone to zone, causing great complexity.
  - the speed of shock
    - Rankine-Hugoniot jump condition
      - $ S = \frac{f(u_r) - f(u_l)}{u_r - u_l} = \frac{u_r + u_l}{2} $
      - where $ S $ is the shock speed, and $ u_r $ and $ u_l $ are the right and left states of the shock.
    - the Riemann problem solution for Burgers' equation
      - if $ u_l > u_r $, then a shock forms, and the solution is:
        - $$ u(x, t) = \begin{cases} u_l & \text{if } x < S t \\ u_r & \text{if } x > S t \end{cases} $$
      - if $ u_l \leq u_r $, then a rarefaction wave forms, and the solution is:
        - $$ u(x, t) = \begin{cases} u_l & \text{if } x < u_l t \\ \frac{x}{t} & \text{if } u_l t \leq x \leq u_r t \\ u_r & \text{if } x > u_r t \end{cases} $$
      - then we can compute the flux $ F^{n+1/2}_{i+1/2} = \frac{1}{2} \left( u^{n+1/2}_{i+1/2} \right)^2 $ based on the above solution.
        - conservative update: $ u^{n+1}_i = u^n_i - \frac{\Delta t}{\Delta x} \left( F^{n+1/2}_{i+1/2} - F^{n+1/2}_{i-1/2} \right) $

- Back to Euler equation
  - conservative form
    - $ \vec{u_t} + [\vec{F}(\vec{u})]_x = 0 $
    - where $ \vec{u} = \begin{pmatrix} \rho \\ \rho v \\ E \end{pmatrix} $ $\space, \space$ $ \vec{F}(\vec{u}) = \begin{pmatrix} \rho v \\ \rho v^2 + P \\ v(E + P) \end{pmatrix} $
    - $ E = e + \frac{1}{2} \rho v^2 $, total energy density
    - closure relation: $ P = (\gamma - 1) \rho e $
    - Jacobian $ \vec{A} = \frac{\partial \vec{F}}{\partial \vec{u}} $
      - then the equation becomes $ \vec{u_t} + \vec{A} \vec{u_x} = 0 $ -- eigenvalue problem
      - solve for eigenvalue $ | \vec{A} - \lambda \vec{I} | = 0 $, we get three eigenvalues:
        - $ \lambda_1 = v - c_s $
        - $ \lambda_2 = v $
        - $ \lambda_3 = v + c_s $
        - where $ c_s = \sqrt{\frac{\gamma P}{\rho}} $ is the sound speed. 
      - these eigenvalues represent the speeds of the three characteristic waves: left-moving sound wave, contact discontinuity, and right-moving sound wave.
      - the three eigenvalues divide the x-t plane into four regions, and in each region the solution is constant along the characteristics.
      
